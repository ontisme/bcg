import{_ as ie}from"./TheFooter-BKW0cnVT.js";import{bz as de,c6 as ue,j as u,c as I,a0 as ce,b as fe,a as D,e as me,u as pe,l as b,V as ve,y as X,t as _e,a3 as he,h as Y,aL as G,c7 as be,f as te,o as ge,aN as we,i as xe,a5 as ye,b8 as ke,a7 as ne,aH as Ce,s as Le,aC as Se,ac as Re,z as J,F as Pe,I as n,B as s,J as g,K as Te,r as Q,A as ae,ai as $e,bm as W,ao as Ne,C as l,E as N,D as y,aq as Be,c8 as Ee,ab as Ie,bf as ze}from"./index-CGAq74Qo.js";import{u as Fe,_ as Me}from"./Select-Dy-1iH-C.js";import{u as j,_ as q}from"./index-BRePxQic.js";import{_ as Ue}from"./Avatar-brC51OoE.js";import{_ as He}from"./Space-BG_M0rkT.js";import{a as Ve,_ as Ae}from"./DescriptionsItem-wmSrFTGm.js";import{_ as Oe}from"./Input-B18i41tj.js";import{a as De,_ as je}from"./FormItem-Dcuhujlk.js";import"./create-D3Vn69pI.js";import"./use-compitable-TQif5LUF.js";import"./Popover-DhAZ_XRh.js";import"./next-frame-once-C5Ksf8W7.js";import"./index-6Uffk3aI.js";function qe(e){return e.nodeType===9?null:e.parentNode}function le(e){if(e===null)return null;const o=qe(e);if(o===null)return null;if(o.nodeType===9)return document.documentElement;if(o.nodeType===1){const{overflow:c,overflowX:f,overflowY:m}=getComputedStyle(o);if(/(auto|scroll|overlay)/.test(c+m+f))return o}return le(o)}function ee(e){return e.nodeName==="#document"}const Ze=e=>{const{popoverColor:o,textColor2:c,primaryColorHover:f,primaryColorPressed:m}=e;return Object.assign(Object.assign({},ue),{color:o,textColor:c,iconColor:c,iconColorHover:f,iconColorPressed:m,boxShadow:"0 2px 8px 0px rgba(0, 0, 0, .12)",boxShadowHover:"0 2px 12px 0px rgba(0, 0, 0, .18)",boxShadowPressed:"0 2px 12px 0px rgba(0, 0, 0, .18)"})},Je={name:"BackTop",common:de,self:Ze},Ke=u("svg",{viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg",xlinkHref:"http://www.w3.org/1999/xlink"},u("g",{stroke:"none","stroke-width":"1","fill-rule":"evenodd"},u("g",{transform:"translate(-139.000000, -4423.000000)","fill-rule":"nonzero"},u("g",{transform:"translate(120.000000, 4285.000000)"},u("g",{transform:"translate(7.000000, 126.000000)"},u("g",{transform:"translate(24.000000, 24.000000) scale(1, -1) translate(-24.000000, -24.000000) translate(12.000000, 12.000000)"},u("g",{transform:"translate(4.000000, 2.000000)"},u("path",{d:"M8,0 C8.51283584,0 8.93550716,0.38604019 8.99327227,0.883378875 L9,1 L9,10.584 L12.2928932,7.29289322 C12.6834175,6.90236893 13.3165825,6.90236893 13.7071068,7.29289322 C14.0675907,7.65337718 14.0953203,8.22060824 13.7902954,8.61289944 L13.7071068,8.70710678 L8.70710678,13.7071068 L8.62544899,13.7803112 L8.618,13.784 L8.59530661,13.8036654 L8.4840621,13.8753288 L8.37133602,13.9287745 L8.22929083,13.9735893 L8.14346259,13.9897165 L8.03324678,13.9994506 L7.9137692,13.9962979 L7.77070917,13.9735893 L7.6583843,13.9401293 L7.57677845,13.9063266 L7.47929125,13.8540045 L7.4048407,13.8036865 L7.38131006,13.7856883 C7.35030318,13.7612383 7.32077858,13.7349921 7.29289322,13.7071068 L2.29289322,8.70710678 L2.20970461,8.61289944 C1.90467972,8.22060824 1.93240926,7.65337718 2.29289322,7.29289322 C2.65337718,6.93240926 3.22060824,6.90467972 3.61289944,7.20970461 L3.70710678,7.29289322 L7,10.585 L7,1 L7.00672773,0.883378875 C7.06449284,0.38604019 7.48716416,0 8,0 Z"}),u("path",{d:"M14.9333333,15.9994506 C15.5224371,15.9994506 16,16.4471659 16,16.9994506 C16,17.5122865 15.5882238,17.9349578 15.0577292,17.9927229 L14.9333333,17.9994506 L1.06666667,17.9994506 C0.477562934,17.9994506 0,17.5517354 0,16.9994506 C0,16.4866148 0.411776203,16.0639435 0.9422708,16.0061783 L1.06666667,15.9994506 L14.9333333,15.9994506 Z"})))))))),Xe=I("back-top",`
 position: fixed;
 right: 40px;
 bottom: 40px;
 cursor: pointer;
 display: flex;
 align-items: center;
 justify-content: center;
 color: var(--n-text-color);
 transition:
 color .3s var(--n-bezier),
 box-shadow .3s var(--n-bezier),
 background-color .3s var(--n-bezier);
 border-radius: var(--n-border-radius);
 height: var(--n-height);
 min-width: var(--n-width);
 box-shadow: var(--n-box-shadow);
 background-color: var(--n-color);
`,[ce(),fe("transition-disabled",{transition:"none !important"}),I("base-icon",`
 font-size: var(--n-icon-size);
 color: var(--n-icon-color);
 transition: color .3s var(--n-bezier);
 `),D("svg",{pointerEvents:"none"}),D("&:hover",{boxShadow:"var(--n-box-shadow-hover)"},[I("base-icon",{color:"var(--n-icon-color-hover)"})]),D("&:active",{boxShadow:"var(--n-box-shadow-pressed)"},[I("base-icon",{color:"var(--n-icon-color-pressed)"})])]),Ye=Object.assign(Object.assign({},te.props),{show:{type:Boolean,default:void 0},right:{type:[Number,String],default:40},bottom:{type:[Number,String],default:40},to:{type:[String,Object],default:"body"},visibilityHeight:{type:Number,default:180},listenTo:[String,Object,Function],"onUpdate:show":{type:Function,default:()=>{}},target:Function,onShow:Function,onHide:Function}),Ge=me({name:"BackTop",inheritAttrs:!1,props:Ye,setup(e){const{mergedClsPrefixRef:o,inlineThemeDisabled:c}=pe(e),f=b(null),m=b(!1);ve(()=>{const{value:d}=f;if(d===null){m.value=!1;return}m.value=d>=e.visibilityHeight});const i=b(!1);X(m,d=>{var r;i.value&&((r=e["onUpdate:show"])===null||r===void 0||r.call(e,d))});const z=_e(e,"show"),L=he(z,m),_=b(!0),S=b(null),F=Y(()=>({right:`calc(${G(e.right)} + ${be.value})`,bottom:G(e.bottom)}));let v,R;X(L,d=>{var r,t;i.value&&(d&&((r=e.onShow)===null||r===void 0||r.call(e)),(t=e.onHide)===null||t===void 0||t.call(e))});const M=te("BackTop","-back-top",Xe,Je,e,o);function p(){var d;if(R)return;R=!0;const r=((d=e.target)===null||d===void 0?void 0:d.call(e))||Fe(e.listenTo)||le(S.value);if(!r)return;v=r===document.documentElement?document:r;const{to:t}=e;typeof t=="string"&&document.querySelector(t),v.addEventListener("scroll",k),k()}function U(){(ee(v)?document.documentElement:v).scrollTo({top:0,behavior:"smooth"})}function k(){f.value=(ee(v)?document.documentElement:v).scrollTop,i.value||Re(()=>{i.value=!0})}function P(){_.value=!1}ge(()=>{p(),_.value=L.value}),we(()=>{v&&v.removeEventListener("scroll",k)});const T=Y(()=>{const{self:{color:d,boxShadow:r,boxShadowHover:t,boxShadowPressed:H,iconColor:$,iconColorHover:V,iconColorPressed:B,width:C,height:A,iconSize:w,borderRadius:x,textColor:E},common:{cubicBezierEaseInOut:O}}=M.value;return{"--n-bezier":O,"--n-border-radius":x,"--n-height":A,"--n-width":C,"--n-box-shadow":r,"--n-box-shadow-hover":t,"--n-box-shadow-pressed":H,"--n-color":d,"--n-icon-size":w,"--n-icon-color":$,"--n-icon-color-hover":V,"--n-icon-color-pressed":B,"--n-text-color":E}}),h=c?xe("back-top",void 0,T,e):void 0;return{placeholderRef:S,style:F,mergedShow:L,isMounted:ye(),scrollElement:b(null),scrollTop:f,DomInfoReady:i,transitionDisabled:_,mergedClsPrefix:o,handleAfterEnter:P,handleScroll:k,handleClick:U,cssVars:c?void 0:T,themeClass:h==null?void 0:h.themeClass,onRender:h==null?void 0:h.onRender}},render(){const{mergedClsPrefix:e}=this;return u("div",{ref:"placeholderRef",class:`${e}-back-top-placeholder`,style:"display: none","aria-hidden":!0},u(ke,{to:this.to,show:this.mergedShow},{default:()=>u(ne,{name:"fade-in-scale-up-transition",appear:this.isMounted,onAfterEnter:this.handleAfterEnter},{default:()=>{var o;return(o=this.onRender)===null||o===void 0||o.call(this),this.mergedShow?u("div",Ce(this.$attrs,{class:[`${e}-back-top`,this.themeClass,this.transitionDisabled&&`${e}-back-top--transition-disabled`],style:[this.style,this.cssVars],onClick:this.handleClick}),Le(this.$slots.default,()=>[u(Se,{clsPrefix:e},{default:()=>Ke})])):null}})}))}}),Qe={class:"cus-scroll h-full flex-col flex-1 bg-#f5f6fb dark:bg-#121212"},We={__name:"AppPage",props:{full:{type:Boolean,default:!1},showFooter:{type:Boolean,default:!1}},setup(e){return(o,c)=>{const f=ie,m=Ge;return J(),Pe("main",Qe,[n(ne,{name:"fade-slide",mode:"out-in",appear:""},{default:s(()=>[g("main",{class:Te([{"flex-1":e.full},"m-12"])},[Q(o.$slots,"default")],2)]),_:3}),o.$slots.footer?Q(o.$slots,"footer",{key:0}):e.showFooter?(J(),ae(f,{key:1,class:"mb-12 mt-auto"})):$e("",!0),n(m,{bottom:20})])}}};function oe(e={}){const o=b(null),c=b({...e});return[o,c,()=>{var i;return(i=o.value)==null?void 0:i.validate()},{required:{required:!0,message:"此为必填项",trigger:["blur","change"]}}]}const Z={changePassword:e=>W.post("/auth/password",e),updateProfile:e=>W.patch(`/user/profile/${e.id}`,e)},eo={class:"ml-20"},oo={class:"flex items-center text-16"},to=g("span",null,"用戶名:",-1),no={class:"ml-12 opacity-80"},ao=g("i",{class:"i-fe:edit mr-4"},null,-1),lo={class:"mt-16 flex items-center"},so=g("span",{class:"ml-12 opacity-60"}," 修改頭像只支持在線鏈接，不提供上傳圖片功能，如有需要可自行對接！ ",-1),ro=g("i",{class:"i-fe:edit mr-4"},null,-1),ko={__name:"index",setup(e){var T,h,d;const o=Ne(),c={required:!0,message:"此為必填項",trigger:["blur","change"]},[f]=j(),[m,i,z]=oe();async function L(){await z(),await Z.changePassword(i.value),$message.success("密碼修改成功"),P()}const _=b(o.avatar),[S]=j();async function F(){if(!_.value)return $message.error("請輸入頭像地址"),!1;await Z.updateProfile({id:o.userId,avatar:_.value}),$message.success("頭像修改成功"),P()}const v=[{label:"保密",value:0},{label:"男",value:1},{label:"女",value:2}],[R]=j(),[M,p,U]=oe({id:o.userId,nickName:o.nickName,gender:((T=o.userInfo)==null?void 0:T.gender)??0,address:(h=o.userInfo)==null?void 0:h.address,email:(d=o.userInfo)==null?void 0:d.email});async function k(){await U(),await Z.updateProfile(p.value),$message.success("資料修改成功"),P()}async function P(){const r=await Ee();o.setUser(r)}return(r,t)=>{const H=Ue,$=Ie,V=He,B=ze,C=Ve,A=Ae,w=Oe,x=De,E=je,O=Me,se=We;return J(),ae(se,{"show-footer":""},{default:s(()=>[n(B,null,{default:s(()=>[n(V,{align:"center"},{default:s(()=>[n(H,{round:"",size:100,src:l(o).avatar},null,8,["src"]),g("div",eo,[g("div",oo,[to,g("span",no,N(l(o).username),1),n($,{class:"ml-32",type:"primary",text:"",onClick:t[0]||(t[0]=a=>l(f).open())},{default:s(()=>[ao,y(" 修改密碼 ")]),_:1})]),g("div",lo,[n($,{type:"primary",ghost:"",onClick:t[1]||(t[1]=a=>l(S).open())},{default:s(()=>[y(" 更改頭像 ")]),_:1}),so])])]),_:1})]),_:1}),n(B,{class:"mt-20",title:"個人資料信息"},{"header-extra":s(()=>[n($,{type:"primary",text:"",onClick:t[2]||(t[2]=a=>l(R).open())},{default:s(()=>[ro,y(" 修改資料 ")]),_:1})]),default:s(()=>[n(A,{"label-placement":"left","label-style":{width:"200px",textAlign:"center"},column:1,bordered:""},{default:s(()=>[n(C,{label:"昵稱"},{default:s(()=>[y(N(l(o).nickName),1)]),_:1}),n(C,{label:"性別"},{default:s(()=>{var a;return[y(N(((a=v.find(re=>{var K;return re.value===((K=l(o).userInfo)==null?void 0:K.gender)}))==null?void 0:a.label)??"未知"),1)]}),_:1}),n(C,{label:"地址"},{default:s(()=>{var a;return[y(N((a=l(o).userInfo)==null?void 0:a.address),1)]}),_:1}),n(C,{label:"郵箱"},{default:s(()=>{var a;return[y(N((a=l(o).userInfo)==null?void 0:a.email),1)]}),_:1})]),_:1})]),_:1}),n(l(q),{ref_key:"avatarModalRef",ref:S,width:"420px",title:"更改頭像",onOk:t[4]||(t[4]=a=>F())},{default:s(()=>[n(w,{value:l(_),"onUpdate:value":t[3]||(t[3]=a=>Be(_)?_.value=a:null)},null,8,["value"])]),_:1},512),n(l(q),{ref_key:"pwdModalRef",ref:f,title:"修改密碼",width:"420px",onOk:t[7]||(t[7]=a=>L())},{default:s(()=>[n(E,{ref_key:"pwdFormRef",ref:m,model:l(i),"label-placement":"left","require-mark-placement":"left"},{default:s(()=>[n(x,{label:"原密碼",path:"oldPassword",rule:c},{default:s(()=>[n(w,{value:l(i).oldPassword,"onUpdate:value":t[5]||(t[5]=a=>l(i).oldPassword=a),type:"password",placeholder:"請輸入原密碼"},null,8,["value"])]),_:1}),n(x,{label:"新密碼",path:"newPassword",rule:c},{default:s(()=>[n(w,{value:l(i).newPassword,"onUpdate:value":t[6]||(t[6]=a=>l(i).newPassword=a),type:"password",placeholder:"請輸入新密碼"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},512),n(l(q),{ref_key:"profileModalRef",ref:R,title:"修改資料",width:"420px",onOk:t[12]||(t[12]=a=>k())},{default:s(()=>[n(E,{ref_key:"profileFormRef",ref:M,model:l(p),"label-placement":"left"},{default:s(()=>[n(x,{label:"昵稱",path:"nickName"},{default:s(()=>[n(w,{value:l(p).nickName,"onUpdate:value":t[8]||(t[8]=a=>l(p).nickName=a),placeholder:"請輸入昵稱"},null,8,["value"])]),_:1}),n(x,{label:"性別",path:"gender"},{default:s(()=>[n(O,{value:l(p).gender,"onUpdate:value":t[9]||(t[9]=a=>l(p).gender=a),options:v,placeholder:"請選擇性別"},null,8,["value"])]),_:1}),n(x,{label:"地址",path:"address"},{default:s(()=>[n(w,{value:l(p).address,"onUpdate:value":t[10]||(t[10]=a=>l(p).address=a),placeholder:"請輸入地址"},null,8,["value"])]),_:1}),n(x,{label:"郵箱",path:"email"},{default:s(()=>[n(w,{value:l(p).email,"onUpdate:value":t[11]||(t[11]=a=>l(p).email=a),placeholder:"請輸入郵箱"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},512)]),_:1})}}};export{ko as default};
